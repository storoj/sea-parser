<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Парсер новостей</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/alertbox.css" rel="stylesheet">
    <link href="/bootstrap/css/datepicker.css" rel="stylesheet">

    <link rel="stylesheet" href="/js/jqplot/jquery.jqplot.min.css">
    <style>
        body {
            padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
        }
    </style>
    <link href="/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>

<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="#">Парсер новостей</a>
            <div class="nav-collapse collapse">
                <ul class="nav" id="navigationTabs">
                    <li><a href="#stats" data-toggle="tab">Статистика</a></li>
                    <li><a href="#settings" data-toggle="tab">Фразы</a></li>
                    <li><a href="#contact" data-toggle="tab">Автор</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </div>
</div>

<div class="container">

    <div class="tab-content">
        <div class="tab-pane active" id="stats">
            <form>
                <fieldset>
                    <legend>Статистика по фразам</legend>

                    <div class="row">
                        <div class="span4">
                            <p class="lead">Фразы, отображаемые на графике</p>
                            <label class="checkbox"><input type="checkbox" name="phrases[morvesti.ru]"> <img src="http://morvesti.ru/favicon.ico"> Морские вести</label>
                            <label class="checkbox"><input type="checkbox" name="phrases[seanews.ru]"> <img src="http://seanews.ru/favicon.ico"> SeaNews</label>
                            <label class="checkbox"><input type="checkbox" name="phrases[portnews.ru]"> <img src="http://portnews.ru/favicon.ico"> ПортНьюс</label>
                            <label class="checkbox"><input type="checkbox" name="phrases[infranews.ru]"> <img src="http://infranews.ru/wp-content/uploads/2012/08/favicon.ico"> Infranews</label>

                            <p class="lead">Тип поиска</p>
                            <label class="radio">
                                <input type="radio" name="optionsRadios" id="optionsRadios1" value="option1" checked>
                                морфологический поиск
                            </label>
                            <label class="radio">
                                <input type="radio" name="optionsRadios" id="optionsRadios2" value="option2">
                                точное совпадение
                            </label>
                        </div>
                        <div class="span3" style="height:300px;">
                            <label>Начальная дата</label>
                            <input type="text" id="calendar1" class="datepicker1" data-date-autohide="0" data-date-initial-show="1">
                            <div class="datepicker" data-target="calendar1"></div>
                        </div>
                        <div class="span3" style="height:300px;">
                            <label>Конечная дата</label>
                            <input type="text" id="calendar2" class="datepicker1" data-date-autohide="0" data-date-initial-show="1">
                            <div class="datepicker" data-target="calendar2"></div>
                        </div>
                    </div>

                    <div class="form-actions" style="text-align: center">
                        <button type="submit" class="btn btn-large btn-primary"><i class="icon-signal icon-white"></i> Построить график</button>
                    </div>
                </fieldset>
            </form>

            <div id="chart1" style="height: 500px; width: 98%"></div>

        </div>
        <div class="tab-pane" id="settings">
            <div class="row">
                <div class="span9">
                    <form id="settings_form">
                        <ul class="nav nav-tabs" id="settingsTabs">
                        </ul>

                        <div class="tab-content">
                        </div>
                    </form>
                </div>
                <div class="span3">
                    <div class="well">
                        <button class="btn btn-success" id="group_add">Добавить группу</button>
                        <hr>
                        <div class="group-info">
                            <h5>Информация о группе</h5>
                            <input id="group_name" type="text" value="current group name" class="input-medium">
                            <button class="btn btn-danger" id="group_remove">Удалить группу</button>
                        </div>
                    </div>
                    <button type="submit" form="settings_form" class="btn btn-primary"><i class="icon-white icon-ok"></i> Сохранить</button>
                </div>
            </div>

        </div>
        <div class="tab-pane" id="contact">
            <p class="lead">skype: dark.storoj</p>
            <p class="lead">mail: dark.storoj@gmail.com</p>
        </div>
    </div>

</div> <!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<!--<script src="../assets/js/jquery.js"></script>-->
<!--<script src="../assets/js/bootstrap-transition.js"></script>-->
<!--<script src="../assets/js/bootstrap-alert.js"></script>-->
<!--<script src="../assets/js/bootstrap-modal.js"></script>-->
<!--<script src="../assets/js/bootstrap-dropdown.js"></script>-->
<!--<script src="../assets/js/bootstrap-scrollspy.js"></script>-->
<!--<script src="../assets/js/bootstrap-tab.js"></script>-->
<!--<script src="../assets/js/bootstrap-tooltip.js"></script>-->
<!--<script src="../assets/js/bootstrap-popover.js"></script>-->
<!--<script src="../assets/js/bootstrap-button.js"></script>-->
<!--<script src="../assets/js/bootstrap-collapse.js"></script>-->
<!--<script src="../assets/js/bootstrap-carousel.js"></script>-->
<!--<script src="../assets/js/bootstrap-typeahead.js"></script>-->
<script src="/js/jquery-1.8.3.min.js"></script>
<script src="/bootstrap/js/bootstrap.min.js"></script>
<script src="/bootstrap/js/bootstrap-datepicker.js"></script>
<script src="/bootstrap/js/bootstrap-datepicker.ru.js"></script>
<script src="/js/alertbox.js"></script>
<script src="/js/core2.js"></script>
<script src="/js/main.js"></script>


<script src="/js/jqplot/jquery.jqplot.min.js"></script>
<script type="text/javascript" src="/js/jqplot/plugins/jqplot.highlighter.min.js"></script>
<script type="text/javascript" src="/js/jqplot/plugins/jqplot.cursor.min.js"></script>
<script type="text/javascript" src="/js/jqplot/plugins/jqplot.dateAxisRenderer.min.js"></script>

<script>
    var query = new AjaxQuery({
        url:"/ajax.php",
        request_type:"GET",
        callbacks:{
            success:function(status, queryResults){
                var lines = [];
                var lineLabels = [];
                for(var i=0; i<queryResults.length; i++) {
                    var queryResult = queryResults[i];
                    var documentsData = queryResult.documents;
                    var linePoints = [];
                    for (var j=0; j<documentsData.length; j++) {
                        var date = new Date(documentsData[j].date * 1000);
                        linePoints.push([date, j+1]);
                    }
                    lines.push(linePoints);
                    lineLabels.push(queryResult.query + ' <b>('+queryResult.total_found+')</b>');
                }

                console.log('lines:');
                console.log(lines);

                var plot1 = $.jqplot('chart1', lines, {
                    title:'Статистика запросов',
                    axes:{
                        xaxis:{
                            renderer:$.jqplot.DateAxisRenderer,
                            tickOptions:{
                                formatString:'%b&nbsp;%#d'
                            }
                        },
                        yaxis:{
                            tickOptions:{
                                formatString:'%d'
                            }
                        }
                    },
                    highlighter: {
                        show: true,
                        sizeAdjust: 7.5
                    },
                    cursor: {
                        show: false
                    },
                    legend: {
                        show: true,
                        labels: lineLabels,
                        location: 'nw'
                    }
                });
            }
        }
    });
    query.execute()
</script>



</body>
</html>
